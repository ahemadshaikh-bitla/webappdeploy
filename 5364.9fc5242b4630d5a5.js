"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5364],{5364:(V,b,l)=>{l.r(b),l.d(b,{CustomOurbusCalenderPage:()=>z});var d=l(2529),c=l(7106),f=l(8091),h=l(4273),p=l(7729);function O(s,i){const t=(0,h.a)(s);if(isNaN(i))return(0,p.w)(s,NaN);if(!i)return t;const n=t.getDate(),a=(0,p.w)(s,t.getTime());return a.setMonth(t.getMonth()+i+1,0),n>=a.getDate()?a:(t.setFullYear(a.getFullYear(),a.getMonth(),n),t)}function v(s,i){return O(s,-i)}function E(s){const i=(0,h.a)(s);return i.setDate(1),i.setHours(0,0,0,0),i}function R(s){const i=(0,h.a)(s),t=i.getFullYear(),n=i.getMonth(),a=(0,p.w)(s,0);return a.setFullYear(t,n+1,0),a.setHours(0,0,0,0),a.getDate()}function P(s){return(0,h.a)(s).getDay()}function w(s,i){const t=+(0,h.a)(s),[n,a]=[+(0,h.a)(i.start),+(0,h.a)(i.end)].sort((o,r)=>o-r);return t>=n&&t<=a}function m(s,i){return+(0,h.a)(s)<+(0,h.a)(i)}var x=l(3601);function M(s,i){return+(0,x.o)(s)==+(0,x.o)(i)}var T=l(906),e=l(277),u=l(4654),I=l(6970),_=l(177);function G(s,i){if(1&s&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&s){const t=i.$implicit;e.R7$(1),e.JRh(t)}}function j(s,i){1&s&&e.nrm(0,"span",16)}const Y=function(s,i,t,n,a){return{disabled:s,selected:i,"in-range":t,"selected-date":n,"range-highlight":a}};function B(s,i){if(1&s){const t=e.RV6();e.j41(0,"button",17),e.bIt("click",function(){const o=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.selectDate(o))}),e.EFF(1),e.k0s()}if(2&s){const t=i.$implicit;e.Y8G("ngClass",e.s1E(2,Y,t.isDisabled,t.isSelected,t.isInRange,t.isSelected,t.isInRange&&!t.isSelected)),e.R7$(1),e.SpI(" ",t.date," ")}}function $(s,i){if(1&s&&(e.j41(0,"div",10)(1,"p"),e.EFF(2),e.k0s(),e.j41(3,"div",11),e.DNE(4,G,2,1,"span",12),e.k0s(),e.j41(5,"div",13),e.DNE(6,j,1,0,"span",14),e.DNE(7,B,2,8,"button",15),e.k0s()()),2&s){const t=i.$implicit,n=e.XpG();e.R7$(2),e.Lme("",t.name," ",t.year,""),e.R7$(2),e.Y8G("ngForOf",n.weekDays),e.R7$(2),e.Y8G("ngForOf",t.startingBlanks),e.R7$(1),e.Y8G("ngForOf",t.days)}}let z=(()=>{class s{constructor(t,n,a){this.modalController=t,this.params=n,this.commonStorage=a,this.months=[],this.weekDays=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],this.today=new Date,this.selectedDates=[],this.selectedEndDate=null,this.originalPreselectedDate=null;let o=n.get("departureDate");const r=(0,d.qg)(o.formattedDate,"dd-MM-yyyy",new Date);this.departureDate=(0,c.GP)(r,"yyyy-MM-dd"),this.type=n.get("type");let g=n.get("departureDateReturn");const S=(0,d.qg)(g.formattedDate,"dd-MM-yyyy",new Date);this.departureDateReturn=(0,c.GP)(S,"yyyy-MM-dd"),this.title=n.get("title"),console.log(" this.departureDate",this.departureDate,"this.type",this.type,"this.departureDateReturn",this.departureDateReturn,"this.title",this.title),this.multipleDateSelection=2===this.type,this.selectedTripSegment=n.get("selectedTripSegment"),console.log("selectedTripSegment",this.selectedTripSegment),this.originalPreselectedDate=r}ngOnInit(){if(this.multipleDateSelection="oneway"!==this.selectedTripSegment&&2===this.type,this.departureDate&&this.departureDate.formattedDate){const t=(0,d.qg)(this.departureDate.formattedDate,"dd-MM-yyyy",new Date);this.departureDate=(0,f.f)(t)?(0,c.GP)(t,"yyyy-MM-dd"):null}if(this.departureDateReturn&&this.departureDateReturn.formattedDate){const t=(0,d.qg)(this.departureDateReturn.formattedDate,"dd-MM-yyyy",new Date);this.departureDateReturn=(0,f.f)(t)?(0,c.GP)(t,"yyyy-MM-dd"):null}if("oneway"===this.selectedTripSegment){const t=(0,d.qg)(this.departureDate,"yyyy-MM-dd",new Date);this.selectedDates=(0,f.f)(t)?[t]:[]}else if(this.departureDate&&this.departureDateReturn){const t=(0,d.qg)(this.departureDate,"yyyy-MM-dd",new Date),n=(0,d.qg)(this.departureDateReturn,"yyyy-MM-dd",new Date);this.selectedDates=[t,n],this.selectedEndDate=n,this.highlightRange()}else if(this.departureDate){const t=(0,d.qg)(this.departureDate,"yyyy-MM-dd",new Date);this.selectedDates=[t]}this.generateCalendar({numMonths:12,showPreviousMonths:!1,preselectedDate:this.departureDate||null,dateRange:"oneway"===this.selectedTripSegment?null:{start:this.departureDate,end:this.departureDateReturn||""}})}generateCalendar({numMonths:t=12,showPreviousMonths:n=!1,preselectedDate:a=null,dateRange:o=null}={}){this.months=[];for(let g=0;g<t;g++){const y=E(n?v(this.today,g):O(this.today,g)),N=R(y),k=[],A=0===P(y)?6:P(y)-1,U=Array(A).fill(null);for(let C=1;C<=N;C++){const D=new Date(y);D.setDate(C);const W=!!o&&w(D,{start:new Date(o.start),end:new Date(o.end)}),X=o?.start?m(D,this.today)||m(D,new Date(o.start)):m(D,this.today);k.push({date:D.getDate(),fullDate:D,isSelected:!!a&&(M(D,new Date(a))||this.selectedEndDate&&M(D,new Date(this.selectedEndDate))),isDisabled:X,isInRange:W,price:`$${Math.floor(100*Math.random())}`})}this.months.push({name:(0,c.GP)(y,"MMMM"),year:(0,c.GP)(y,"yyyy"),days:k,startingBlanks:U})}n&&this.months.reverse(),o&&this.highlightRange()}selectDate(t){t.isDisabled||(this.multipleDateSelection?this.departureDate===t.fullDate.format("YYYY-MM-DD")&&1===this.selectedDates.length?(this.selectedDates.push(t.fullDate),this.selectedEndDate=t.fullDate,this.markSelectedDate(this.departureDate),this.markSelectedDate(this.selectedEndDate),this.highlightRange()):this.handleMultipleDateSelection(t):this.handleSingleDateSelection(t))}handleSingleDateSelection(t){this.clearSelectedDates(),this.selectedDates=[t.fullDate],t.isSelected=!0}handleMultipleDateSelection(t){0===this.selectedDates.length&&(this.selectedDates=[(0,d.qg)(this.departureDate,"yyyy-MM-dd",new Date)],this.markSelectedDate((0,d.qg)(this.departureDate,"yyyy-MM-dd",new Date))),1===this.selectedDates.length?(t.isSelected=!0,this.selectedEndDate=t.fullDate,this.selectedDates.push(t.fullDate),this.markSelectedDate(this.selectedEndDate),this.highlightRange()):2===this.selectedDates.length&&(this.clearSelectedDates(),this.selectedDates=[(0,d.qg)(this.departureDate,"yyyy-MM-dd",new Date),t.fullDate],this.selectedEndDate=t.fullDate,this.markSelectedDate((0,d.qg)(this.departureDate,"yyyy-MM-dd",new Date)),this.markSelectedDate(this.selectedEndDate),this.highlightRange())}markSelectedDate(t){const n=(0,c.GP)(t,"yyyy-MM-dd");this.months.forEach(a=>{a.days.forEach(o=>{o.fullDate.isSame(n,"day")&&(o.isSelected=!0)})})}clearEndDateSelection(){this.months.forEach(t=>{t.days.forEach(n=>{n.fullDate.isSame(this.selectedEndDate)&&(n.isSelected=!1,n.isInRange=!1)})}),this.selectedEndDate=null}clearSelectedDates(){this.months.forEach(t=>{t.days.forEach(n=>{n.isSelected=!1,n.isInRange=!1})}),this.selectedDates=[]}highlightRange(){if(this.selectedDates.length<2)return;const t=this.selectedDates[0],n=this.selectedDates[1];this.months.forEach(a=>{a.days.forEach(o=>{const r=o.fullDate;o.isInRange=r.isAfter(t,"day")&&r.isBefore(n,"day"),(r.isSame(t,"day")||r.isSame(n,"day"))&&(o.isSelected=!0)})})}confirmSelection(){0===this.selectedDates.length&&this.departureDate&&(this.selectedDates=[(0,d.qg)(this.departureDate,"yyyy-MM-dd",new Date)]),this.selectedDates.sort((a,o)=>function F(s,i){const t=(0,h.a)(s),n=(0,h.a)(i),a=t.getTime()-n.getTime();return a<0?-1:a>0?1:a}(a,o));const t=this.selectedDates[0],n=this.selectedDates.length>1?this.selectedDates[this.selectedDates.length-1]:t;if(1===this.type)this.modalController.dismiss({start_date:(0,c.GP)(t,"yyyy-MM-dd")});else if(2===this.type){this.modalController.dismiss({start_date:(0,c.GP)(t,"yyyy-MM-dd"),end_date:(0,c.GP)(n,"yyyy-MM-dd")});const a=(0,c.GP)(t,"yyyy-MM-dd"),o=(0,c.GP)(n,"yyyy-MM-dd");this.commonStorage.localSet("isSameStartEndDate",a===o?"yes":"no");const r=(0,c.GP)(new Date,"yyyy-MM-dd");this.commonStorage.localSet("isCSameStartEndDate",a===r&&o===r?"yes":"no");const g=M(n,(0,T.f)(t,1));this.commonStorage.localSet("isNextDay",g?"yes":"no")}}gotoback(){this.modalController.dismiss()}static{this.\u0275fac=function(n){return new(n||s)(e.rXU(u.W3),e.rXU(u.y8),e.rXU(I.P))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-custom-ourbus-calender"]],decls:13,vars:1,consts:[[1,"ourbustheme",2,"box-shadow","0px 4px 8px 0px #00000014"],["size","2",1,"col",3,"click"],["name","arrow-back-outline"],["size","8"],[1,"header_p"],["size","2"],[1,"ourbustheme"],["class","month-section",4,"ngFor","ngForOf"],[1,"ourbustheme",2,"box-shadow","0px 13px 10px 21px #00000014"],["expand","block",1,"ourbus_btn",3,"click"],[1,"month-section"],[1,"week-days"],[4,"ngFor","ngForOf"],[1,"days-grid"],["class","day blank",4,"ngFor","ngForOf"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"day","blank"],[3,"ngClass","click"]],template:function(n,a){1&n&&(e.j41(0,"ion-header",0)(1,"ion-row")(2,"ion-col",1),e.bIt("click",function(){return a.gotoback()}),e.nrm(3,"ion-icon",2),e.k0s(),e.j41(4,"ion-col",3)(5,"p",4),e.EFF(6,"Choose your date(s)"),e.k0s()(),e.nrm(7,"ion-col",5),e.k0s()(),e.j41(8,"ion-content",6),e.DNE(9,$,8,5,"div",7),e.k0s(),e.j41(10,"ion-footer",8)(11,"ion-button",9),e.bIt("click",function(){return a.confirmSelection()}),e.EFF(12,"Select Dates"),e.k0s()()),2&n&&(e.R7$(9),e.Y8G("ngForOf",a.months))},dependencies:[_.YU,_.Sq,u.Jm,u.hU,u.W9,u.M0,u.eU,u.iq,u.ln],styles:['ion-content[_ngcontent-%COMP%]{--background: #ffffff}.month-section[_ngcontent-%COMP%]{padding:10px}.month-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:left;margin-left:10px;font-weight:700}.week-days[_ngcontent-%COMP%]{display:flex;justify-content:space-around;font-weight:700;margin-bottom:14px;margin-top:25px}.days-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:0px}button[_ngcontent-%COMP%]{background:transparent;border:none;font-size:14px;position:relative;padding:0;height:55px;width:100%;border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#333}button.selected[_ngcontent-%COMP%]{background-color:var(--iconsAndButtonsColor);color:var(--primaryText)}button.in-range[_ngcontent-%COMP%]{position:relative;color:#333;border-radius:0;z-index:1;overflow:hidden}button.in-range[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background-color:var(--iconsAndButtonsColor);opacity:.1;z-index:-1;border-radius:inherit}button.disabled[_ngcontent-%COMP%]{color:#ccc;pointer-events:none}button[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:10px;color:#666;margin-top:4px}.range-line[_ngcontent-%COMP%]{position:absolute;top:50%;left:0;right:0;height:100%;background-color:#eef7ed;z-index:-1}.col[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.col[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:25px}.header_p[_ngcontent-%COMP%]{text-align:center;font-size:20px;font-weight:700}.ourbus_btn[_ngcontent-%COMP%]{height:50px;box-shadow:none;--border-radius: 8px;font-size:18px;font-weight:700;--background:var(--iconsAndButtonsColor);--color:var(--primaryText);margin:16px;--background-activated:var(--iconsAndButtonsColor)}.range-highlight[_ngcontent-%COMP%], .selected-date[_ngcontent-%COMP%]{border-radius:18%}']})}}return s})()}}]);