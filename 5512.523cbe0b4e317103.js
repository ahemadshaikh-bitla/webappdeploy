"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5512,5364],{5512:(G,p,r)=>{r.r(p),r.d(p,{CustomOurbusCalenderPageModule:()=>F});var l=r(177),d=r(8326),M=r(4654),h=r(7944),C=r(5364),f=r(277);const E=[{path:"",component:C.CustomOurbusCalenderPage}];let b=(()=>{class u{static{this.\u0275fac=function(S){return new(S||u)}}static{this.\u0275mod=f.$C({type:u})}static{this.\u0275inj=f.G2t({imports:[h.iI.forChild(E),h.iI]})}}return u})(),F=(()=>{class u{static{this.\u0275fac=function(S){return new(S||u)}}static{this.\u0275mod=f.$C({type:u})}static{this.\u0275inj=f.G2t({imports:[l.MD,d.YN,M.bv,b]})}}return u})()},5364:(G,p,r)=>{r.r(p),r.d(p,{CustomOurbusCalenderPage:()=>W});var l=r(2529),d=r(7106),M=r(8091),h=r(4273),C=r(7729);function f(s,o){const t=(0,h.a)(s);if(isNaN(o))return(0,C.w)(s,NaN);if(!o)return t;const n=t.getDate(),a=(0,C.w)(s,t.getTime());return a.setMonth(t.getMonth()+o+1,0),n>=a.getDate()?a:(t.setFullYear(a.getFullYear(),a.getMonth(),n),t)}function b(s,o){return f(s,-o)}function u(s){const o=(0,h.a)(s);return o.setDate(1),o.setHours(0,0,0,0),o}function O(s){const o=(0,h.a)(s),t=o.getFullYear(),n=o.getMonth(),a=(0,C.w)(s,0);return a.setFullYear(t,n+1,0),a.setHours(0,0,0,0),a.getDate()}function k(s){return(0,h.a)(s).getDay()}function j(s,o){const t=+(0,h.a)(s),[n,a]=[+(0,h.a)(o.start),+(0,h.a)(o.end)].sort((i,c)=>i-c);return t>=n&&t<=a}function P(s,o){return+(0,h.a)(s)<+(0,h.a)(o)}var w=r(3601);function x(s,o){return+(0,w.o)(s)==+(0,w.o)(o)}var $=r(906),e=r(277),g=r(4654),B=r(6970),T=r(177);function N(s,o){if(1&s&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&s){const t=o.$implicit;e.R7$(1),e.JRh(t)}}function z(s,o){1&s&&e.nrm(0,"span",16)}const _=function(s,o,t,n,a){return{disabled:s,selected:o,"in-range":t,"selected-date":n,"range-highlight":a}};function A(s,o){if(1&s){const t=e.RV6();e.j41(0,"button",17),e.bIt("click",function(){const i=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.selectDate(i))}),e.EFF(1),e.k0s()}if(2&s){const t=o.$implicit;e.Y8G("ngClass",e.s1E(2,_,t.isDisabled,t.isSelected,t.isInRange,t.isSelected,t.isInRange&&!t.isSelected)),e.R7$(1),e.SpI(" ",t.date," ")}}function U(s,o){if(1&s&&(e.j41(0,"div",10)(1,"p"),e.EFF(2),e.k0s(),e.j41(3,"div",11),e.DNE(4,N,2,1,"span",12),e.k0s(),e.j41(5,"div",13),e.DNE(6,z,1,0,"span",14),e.DNE(7,A,2,8,"button",15),e.k0s()()),2&s){const t=o.$implicit,n=e.XpG();e.R7$(2),e.Lme("",t.name," ",t.year,""),e.R7$(2),e.Y8G("ngForOf",n.weekDays),e.R7$(2),e.Y8G("ngForOf",t.startingBlanks),e.R7$(1),e.Y8G("ngForOf",t.days)}}let W=(()=>{class s{constructor(t,n,a){this.modalController=t,this.params=n,this.commonStorage=a,this.months=[],this.weekDays=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],this.today=new Date,this.selectedDates=[],this.selectedEndDate=null,this.originalPreselectedDate=null;let i=n.get("departureDate");const c=(0,l.qg)(i.formattedDate,"dd-MM-yyyy",new Date);this.departureDate=(0,d.GP)(c,"yyyy-MM-dd"),this.type=n.get("type");let y=n.get("departureDateReturn");const v=(0,l.qg)(y.formattedDate,"dd-MM-yyyy",new Date);this.departureDateReturn=(0,d.GP)(v,"yyyy-MM-dd"),this.title=n.get("title"),console.log(" this.departureDate",this.departureDate,"this.type",this.type,"this.departureDateReturn",this.departureDateReturn,"this.title",this.title),this.multipleDateSelection=2===this.type,this.selectedTripSegment=n.get("selectedTripSegment"),console.log("selectedTripSegment",this.selectedTripSegment),this.originalPreselectedDate=c}ngOnInit(){if(this.multipleDateSelection="oneway"!==this.selectedTripSegment&&2===this.type,this.departureDate&&this.departureDate.formattedDate){const t=(0,l.qg)(this.departureDate.formattedDate,"dd-MM-yyyy",new Date);this.departureDate=(0,M.f)(t)?(0,d.GP)(t,"yyyy-MM-dd"):null}if(this.departureDateReturn&&this.departureDateReturn.formattedDate){const t=(0,l.qg)(this.departureDateReturn.formattedDate,"dd-MM-yyyy",new Date);this.departureDateReturn=(0,M.f)(t)?(0,d.GP)(t,"yyyy-MM-dd"):null}if("oneway"===this.selectedTripSegment){const t=(0,l.qg)(this.departureDate,"yyyy-MM-dd",new Date);this.selectedDates=(0,M.f)(t)?[t]:[]}else if(this.departureDate&&this.departureDateReturn){const t=(0,l.qg)(this.departureDate,"yyyy-MM-dd",new Date),n=(0,l.qg)(this.departureDateReturn,"yyyy-MM-dd",new Date);this.selectedDates=[t,n],this.selectedEndDate=n,this.highlightRange()}else if(this.departureDate){const t=(0,l.qg)(this.departureDate,"yyyy-MM-dd",new Date);this.selectedDates=[t]}this.generateCalendar({numMonths:12,showPreviousMonths:!1,preselectedDate:this.departureDate||null,dateRange:"oneway"===this.selectedTripSegment?null:{start:this.departureDate,end:this.departureDateReturn||""}})}generateCalendar({numMonths:t=12,showPreviousMonths:n=!1,preselectedDate:a=null,dateRange:i=null}={}){this.months=[];for(let y=0;y<t;y++){const m=u(n?b(this.today,y):f(this.today,y)),X=O(m),I=[],V=0===k(m)?6:k(m)-1,L=Array(V).fill(null);for(let R=1;R<=X;R++){const D=new Date(m);D.setDate(R);const H=!!i&&j(D,{start:new Date(i.start),end:new Date(i.end)}),J=i?.start?P(D,this.today)||P(D,new Date(i.start)):P(D,this.today);I.push({date:D.getDate(),fullDate:D,isSelected:!!a&&(x(D,new Date(a))||this.selectedEndDate&&x(D,new Date(this.selectedEndDate))),isDisabled:J,isInRange:H,price:`$${Math.floor(100*Math.random())}`})}this.months.push({name:(0,d.GP)(m,"MMMM"),year:(0,d.GP)(m,"yyyy"),days:I,startingBlanks:L})}n&&this.months.reverse(),i&&this.highlightRange()}selectDate(t){t.isDisabled||(this.multipleDateSelection?this.departureDate===t.fullDate.format("YYYY-MM-DD")&&1===this.selectedDates.length?(this.selectedDates.push(t.fullDate),this.selectedEndDate=t.fullDate,this.markSelectedDate(this.departureDate),this.markSelectedDate(this.selectedEndDate),this.highlightRange()):this.handleMultipleDateSelection(t):this.handleSingleDateSelection(t))}handleSingleDateSelection(t){this.clearSelectedDates(),this.selectedDates=[t.fullDate],t.isSelected=!0}handleMultipleDateSelection(t){0===this.selectedDates.length&&(this.selectedDates=[(0,l.qg)(this.departureDate,"yyyy-MM-dd",new Date)],this.markSelectedDate((0,l.qg)(this.departureDate,"yyyy-MM-dd",new Date))),1===this.selectedDates.length?(t.isSelected=!0,this.selectedEndDate=t.fullDate,this.selectedDates.push(t.fullDate),this.markSelectedDate(this.selectedEndDate),this.highlightRange()):2===this.selectedDates.length&&(this.clearSelectedDates(),this.selectedDates=[(0,l.qg)(this.departureDate,"yyyy-MM-dd",new Date),t.fullDate],this.selectedEndDate=t.fullDate,this.markSelectedDate((0,l.qg)(this.departureDate,"yyyy-MM-dd",new Date)),this.markSelectedDate(this.selectedEndDate),this.highlightRange())}markSelectedDate(t){const n=(0,d.GP)(t,"yyyy-MM-dd");this.months.forEach(a=>{a.days.forEach(i=>{i.fullDate.isSame(n,"day")&&(i.isSelected=!0)})})}clearEndDateSelection(){this.months.forEach(t=>{t.days.forEach(n=>{n.fullDate.isSame(this.selectedEndDate)&&(n.isSelected=!1,n.isInRange=!1)})}),this.selectedEndDate=null}clearSelectedDates(){this.months.forEach(t=>{t.days.forEach(n=>{n.isSelected=!1,n.isInRange=!1})}),this.selectedDates=[]}highlightRange(){if(this.selectedDates.length<2)return;const t=this.selectedDates[0],n=this.selectedDates[1];this.months.forEach(a=>{a.days.forEach(i=>{const c=i.fullDate;i.isInRange=c.isAfter(t,"day")&&c.isBefore(n,"day"),(c.isSame(t,"day")||c.isSame(n,"day"))&&(i.isSelected=!0)})})}confirmSelection(){0===this.selectedDates.length&&this.departureDate&&(this.selectedDates=[(0,l.qg)(this.departureDate,"yyyy-MM-dd",new Date)]),this.selectedDates.sort((a,i)=>function Y(s,o){const t=(0,h.a)(s),n=(0,h.a)(o),a=t.getTime()-n.getTime();return a<0?-1:a>0?1:a}(a,i));const t=this.selectedDates[0],n=this.selectedDates.length>1?this.selectedDates[this.selectedDates.length-1]:t;if(1===this.type)this.modalController.dismiss({start_date:(0,d.GP)(t,"yyyy-MM-dd")});else if(2===this.type){this.modalController.dismiss({start_date:(0,d.GP)(t,"yyyy-MM-dd"),end_date:(0,d.GP)(n,"yyyy-MM-dd")});const a=(0,d.GP)(t,"yyyy-MM-dd"),i=(0,d.GP)(n,"yyyy-MM-dd");this.commonStorage.localSet("isSameStartEndDate",a===i?"yes":"no");const c=(0,d.GP)(new Date,"yyyy-MM-dd");this.commonStorage.localSet("isCSameStartEndDate",a===c&&i===c?"yes":"no");const y=x(n,(0,$.f)(t,1));this.commonStorage.localSet("isNextDay",y?"yes":"no")}}gotoback(){this.modalController.dismiss()}static{this.\u0275fac=function(n){return new(n||s)(e.rXU(g.W3),e.rXU(g.y8),e.rXU(B.P))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-custom-ourbus-calender"]],decls:13,vars:1,consts:[[1,"ourbustheme",2,"box-shadow","0px 4px 8px 0px #00000014"],["size","2",1,"col",3,"click"],["name","arrow-back-outline"],["size","8"],[1,"header_p"],["size","2"],[1,"ourbustheme"],["class","month-section",4,"ngFor","ngForOf"],[1,"ourbustheme",2,"box-shadow","0px 13px 10px 21px #00000014"],["expand","block",1,"ourbus_btn",3,"click"],[1,"month-section"],[1,"week-days"],[4,"ngFor","ngForOf"],[1,"days-grid"],["class","day blank",4,"ngFor","ngForOf"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"day","blank"],[3,"ngClass","click"]],template:function(n,a){1&n&&(e.j41(0,"ion-header",0)(1,"ion-row")(2,"ion-col",1),e.bIt("click",function(){return a.gotoback()}),e.nrm(3,"ion-icon",2),e.k0s(),e.j41(4,"ion-col",3)(5,"p",4),e.EFF(6,"Choose your date(s)"),e.k0s()(),e.nrm(7,"ion-col",5),e.k0s()(),e.j41(8,"ion-content",6),e.DNE(9,U,8,5,"div",7),e.k0s(),e.j41(10,"ion-footer",8)(11,"ion-button",9),e.bIt("click",function(){return a.confirmSelection()}),e.EFF(12,"Select Dates"),e.k0s()()),2&n&&(e.R7$(9),e.Y8G("ngForOf",a.months))},dependencies:[T.YU,T.Sq,g.Jm,g.hU,g.W9,g.M0,g.eU,g.iq,g.ln],styles:['ion-content[_ngcontent-%COMP%]{--background: #ffffff}.month-section[_ngcontent-%COMP%]{padding:10px}.month-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:left;margin-left:10px;font-weight:700}.week-days[_ngcontent-%COMP%]{display:flex;justify-content:space-around;font-weight:700;margin-bottom:14px;margin-top:25px}.days-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:0px}button[_ngcontent-%COMP%]{background:transparent;border:none;font-size:14px;position:relative;padding:0;height:55px;width:100%;border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#333}button.selected[_ngcontent-%COMP%]{background-color:var(--iconsAndButtonsColor);color:var(--primaryText)}button.in-range[_ngcontent-%COMP%]{position:relative;color:#333;border-radius:0;z-index:1;overflow:hidden}button.in-range[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background-color:var(--iconsAndButtonsColor);opacity:.1;z-index:-1;border-radius:inherit}button.disabled[_ngcontent-%COMP%]{color:#ccc;pointer-events:none}button[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:10px;color:#666;margin-top:4px}.range-line[_ngcontent-%COMP%]{position:absolute;top:50%;left:0;right:0;height:100%;background-color:#eef7ed;z-index:-1}.col[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.col[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:25px}.header_p[_ngcontent-%COMP%]{text-align:center;font-size:20px;font-weight:700}.ourbus_btn[_ngcontent-%COMP%]{height:50px;box-shadow:none;--border-radius: 8px;font-size:18px;font-weight:700;--background:var(--iconsAndButtonsColor);--color:var(--primaryText);margin:16px;--background-activated:var(--iconsAndButtonsColor)}.range-highlight[_ngcontent-%COMP%], .selected-date[_ngcontent-%COMP%]{border-radius:18%}']})}}return s})()}}]);